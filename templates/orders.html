{% extends "layout.html" %}
{% block content %}
  {% if orders_with_totals %}
  <table>
    <thead>
      <tr>
        <th>Order ID</th>
        <th>Customer</th>
        <th>Items</th>
        <th>Total</th>
        <th>Delivery Person</th>
        <th>Delivery Address</th>
        <th>Order Time</th>
        <th>Pickup Time</th>
        <th>Expected Delivery Time</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      {% for order, discounts in orders_with_totals %}
      <tr>
        <td>{{ order.order_id }}</td>
        <td>{{ order.customer.full_name }}</td>
        <td>
          {% if order.order_items %}
            <ul style="margin: 0; padding-left: 1rem;">
              {% for item in order.order_items %}
                <li>{{ item.amount }} √ó {{ item.menu_item.item_name }}</li>
              {% endfor %}
            </ul>
          {% else %}‚Äî{% endif %}
        </td>
        <td>‚Ç¨ {{ '%.2f'|format(discounts.total) }}</td>
        <td>{{ order.delivery_person.full_name }}</td>
        <td>{{ order.delivery_address or "Not specified" }}</td>
        <td>{{ order.order_time.strftime('%Y-%m-%d %H:%M') }}</td>
        <td>{{ order.pickup_time.strftime('%Y-%m-%d %H:%M') }}</td>
        <td>{{ order.expected_delivery_time.strftime('%Y-%m-%d %H:%M") }}</td>
        <td>
          {% if order.status == 'delivered' %}
            <span style="color: green;">‚úì Delivered</span>
          {% elif order.status == 'out_for_delivery' %}
            <span style="color: orange;">üöö Out for Delivery</span>
          {% else %}
            <span style="color: blue;">‚è≥ Pending</span>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p>No orders yet.</p>
  {% endif %}
{% endblock %}