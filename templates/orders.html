{% extends "layout.html" %}
{% block content %}
  {% if orders_with_totals %}
  <table>
    <thead>
      <tr>
        <th>Order ID</th>
        <th>Customer</th>
        <th>Items</th>
        <th>Total</th>
        <th>Delivery Person</th>
        <th>Delivery Address</th>
        <th>Order Time</th>
      </tr>
    </thead>
    <tbody>
      {% for order, discounts in orders_with_totals %}
      <tr>
        <td>{{ order.order_id }}</td>
        <td>{{ order.customer.full_name }}</td>
        <td>
          {% if order.order_items %}
            <ul style="margin: 0; padding-left: 1rem;">
              {% for item in order.order_items %}
                <li>{{ item.amount }} × {{ item.menu_item.item_name }}</li>
              {% endfor %}
            </ul>
          {% else %}—{% endif %}
        </td>
        <td>€ {{ '%.2f'|format(discounts.total) }}</td>
        <td>{{ order.delivery_person.full_name }}</td>
        <td>{{ order.delivery_address or "Not specified" }}</td>
        <td>{{ order.order_time.strftime('%Y-%m-%d %H:%M') }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
    <p>No orders yet.</p>
  {% endif %}
{% endblock %}